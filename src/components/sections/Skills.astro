---
import Section from "../Section.astro";
import HTML from "@/icons/html.astro";
import CSS from "@/icons/css.astro";
import JavaScript from "@/icons/javascript.astro";
import TypeScript from "@/icons/type.astro";
import React from "@/icons/react.astro";
import Node from "@/icons/node.astro";
import MySQL from "@/icons/sql.astro";
import Tailwind from "@/icons/tailwind.astro";
import Next from "@/icons/next.astro";
import Docker from "@/icons/docker.astro";
import mongoDB from "@/icons/mongodb.astro";
import Nest from "@/icons/nest.astro";
import Database from "@/icons/database.astro";
import Express from "@/icons/express.astro";
import APIs from "@/icons/apis.astro";
import Tools from "@/icons/tools.astro";
import { skills, techStack } from "@cv";
import Proyecto from "@/icons/proyecto.astro";
import DevOps from "@/icons/devops.astro";

const SKILLS_ICONS: Record<string, any> = {
  HTML,
  CSS,
  JavaScript,
  TypeScript,
  React,
  Node,
  MySQL,
  Next,
  Tailwind,
  Docker,
  mongoDB,
  Nest,
  Database,
  Express,
  APIs,
  Tools,
  Proyecto,
  DevOps,
};

const ICON_MAP: Record<string, string> = {
  "Next.js": "Next",
  "Base de datos": "Database",
  "Herramientas de Desarrollo": "Tools",
  "GestiÃ³n de Proyectos": "Proyecto"
};

const frontEndSkills = skills.filter((skill) =>
  skill.keywords.includes("Frontend")
);
const backEndSkills = skills.filter(
  (skill) =>
    skill.keywords.includes("Backend") && !skill.keywords.includes("Frontend")
);
const toolSkills = skills.filter(
  (skill) =>
    !skill.keywords.includes("Frontend") && !skill.keywords.includes("Backend")
);
---

<Section title="Tech Stack">
  <p>
    {techStack.description}
  </p>
</Section>

<Section title="Frontend">
  <ul>
    {
      frontEndSkills.map(({ name, description }) => {
        const iconName = ICON_MAP[name] || name;
        const Icon = SKILLS_ICONS[iconName];
        return (
          <li>
            {Icon && <Icon />}
            <div class="skill-text">
              <strong>{name}</strong>
              {description && <span>{description}</span>}
            </div>
          </li>
        );
      })
    }
  </ul>
</Section>

<Section title="Backend">
  <ul>
    {
      backEndSkills.map(({ name, description }) => {
        const iconName = ICON_MAP[name] || name;
        const Icon = SKILLS_ICONS[iconName];
        return (
          <li>
            {Icon && <Icon />}
            <div class="skill-text">
              <strong>{name}</strong>
              {description && <span>{description}</span>}
            </div>
          </li>
        );
      })
    }
  </ul>
</Section>

<Section title="Tools">
  <ul>
    {
      toolSkills.map(({ name, description }) => {
        const iconName = ICON_MAP[name] || name;
        const Icon = SKILLS_ICONS[iconName];
        return (
          <li>
            {Icon && <Icon />}
            <div class="skill-text">
              <strong>{name}</strong>
              {description && <span>{description}</span>}
            </div>
          </li>
        );
      })
    }
  </ul>
</Section>

<style>
  ul {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  li {
    display: flex;
    align-items: center;
    background: transparent;
    padding: 0.5rem;
    gap: 0.5rem;
    border: 1px solid var(--border-color, #ccc);
    border-radius: 6px;
  }

  :root {
    --border-color: #ccc;
  }
  html.dark {
    --border-color: #ccc;
  }

  .icon svg {
    width: 2rem;
    height: 2rem;
    fill: var(--icon-color, #000);
  }

  :root {
    --icon-color: #000;
  }
  html.dark {
    --icon-color: #000;
  }

  .skill-text {
    display: flex;
    flex-direction: column;
    color: var(--subtext-color);
  }
  .skill-text strong {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-color);
  }
  .skill-text span {
    font-size: 0.8rem;
    color: var(--subtext-color);
  }

  p {
    margin-bottom: 1rem;
    color: var(--subtext-color);
  }

  Section {
    margin-bottom: 2rem;
  }
</style>
